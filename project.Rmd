---
title: "Project Checkpoint 1"
author: "Ikran Sheikh-Mursal"
date: "4/21/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

```{r, echo=FALSE}
#plotting and exploring
library(tidyverse) #for plotting and summarizing
library(GGally) #for nice scatterplot matrix 
library(ggridges) #for joy/ridge plots
library(corrplot) #for basic correlation matrix plot
library(naniar) #for exploring missing values
library(pdp) #for partial dependence plots, MARS models
library(rpart.plot) #for plotting decision trees
library(vip) #for importance plots
library(pROC) #for ROC curves
library(plotROC) #for plotting ROC curves

#making things look nice
library(lubridate) #for nice dates
library(knitr) #for nice tables
library(scales) #for nice labels on graphs
library(gridExtra) #for arranging plots
library(broom) #for nice model output
library(janitor) #for nice names

#data
library(ISLR) #for data
library(moderndive) #for data
library(rattle) #weather data

#modeling
library(rsample) #for splitting data
library(recipes) #for keeping track of transformations
library(caret) #for modeling
library(leaps) #for variable selection
library(glmnet) #for LASSO
library(earth) #for MARS models
library(rpart) #for decision trees
library(randomForest) #for bagging and random forests

theme_set(theme_minimal())
```

```{r, echo = FALSE}
attrition <- read.csv("attrition.csv", fileEncoding="UTF-8-BOM")
names(attrition)


#check if we have missing values..
# attrition %>%
#   add_n_miss() %>%
#   arrange(desc(n_miss_all))

attrition <- attrition %>% 
mutate(WorkLifeBalance = fct_recode(as.factor(WorkLifeBalance),                                  Bad = "1", Good = "2", Better = "3", Best = "4"))

#want to remove -0.04 from YearsAtCompany
# attrition %>%
#   arrange(YearsAtCompany)

#split into training and testing
set.seed(253)
attrition_split <- initial_split(attrition, prop = .7)

attrition_train <- training(attrition_split)
attrition_test <- testing(attrition_split)
```
```{r}
#summarise response variable (proportions)
table(attrition_train$Attrition) %>%
  prop.table()
```

This dataset includes an 83.77% retention rate and a 16.23% attrition rate.

##Potential research question: What factors may lead a potential employee to attrite?

```{r}
attrition_train %>%
  # mutate(age_range <- cut(attrition$Age, 6)) %>%
  ggplot(aes(x = Attrition, fill = cut(Age, 4))) +
  geom_bar(position = "fill")
```

```{r, eval = FALSE}
attrition %>%
  ggplot(aes(x=Attrition, fill=cut(YearsAtCompany, breaks = c(0,10,20,Inf), right = FALSE))) +
  geom_bar(position = "fill") +
  scale_fill_discrete("Years at Company and Attrition")
```
```{r}

```


```{r}
#a different look at years at company and attrition
attrition %>%
  ggplot(aes(fill=Attrition, x=cut(YearsAtCompany, 4))) +
  geom_bar(position = "fill")
```


```{r}
#gender vs attrition
attrition %>%
  # mutate(age_range <- cut(attrition$Age, 6)) %>%
  ggplot(aes(fill = Attrition, x = Gender)) +
  geom_bar(position = "fill")
```

```{r}
#work life balance vs attrition
attrition %>%
  # mutate(age_range <- cut(attrition$Age, 6)) %>%
  ggplot(aes(fill = Attrition, x = WorkLifeBalance)) +
  geom_bar(position = "fill")

#WorkLifeBalance 
#1 'Bad'
#2 'Good'
#3 'Better'
#4 'Best'
```

```{r}
attrition %>%
  # mutate(age_range <- cut(attrition$Age, 6)) %>%
  ggplot(aes(fill = Attrition, x = EnvironmentSatisfaction)) +
  geom_bar(position = "fill")

#1 'Low'
#2 'Medium'
#3 'High'
#4 'Very High'
```
```{r}
attrition %>%
  # mutate(age_range <- cut(attrition$Age, 6)) %>%
  ggplot(aes(fill = Attrition, x = RelationshipSatisfaction)) +
  geom_bar(position = "fill")
```
```{r}
#overtime vs attrition
attrition %>%
  # mutate(age_range <- cut(attrition$Age, 6)) %>%
  ggplot(aes(fill = Attrition, x = OverTime)) +
  geom_bar(position = "fill")

#potentially use in model
```


